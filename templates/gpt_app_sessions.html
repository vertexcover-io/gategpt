<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
	<title>Document</title>
</head>

<body>
	<div class="container">
		<h2 class="mt-4">GPT APP Sessions Table</h2>
		<input type="text" id="searchInput" onkeyup="searchFunction()" placeholder="Search for names.."
			class="form-control mb-3" />

		<table id="sessionsTable" class="table table-striped">
			<thead class="thead-dark">
				<tr>
					<th>Email</th>
					<th>Name</th>
					<th>Created At</th>
				</tr>
			</thead>
			<tbody></tbody>
		</table>
	</div>
	<script>
		let pathname = new URL(window.location.href).pathname;
		let fullPath = `/api/v1${pathname}`;
		let input, table, tr, td, i, txtValue;

		input = document.getElementById("searchInput");
		table = document.getElementById("sessionsTable");
		tr = table.getElementsByTagName("tr");

		(async function () {
			let response;
			try {
				response = await fetch(fullPath);
			} catch (e) {
				console.error(e);
			}
			try {
				let data = await response.json();
				for (var i = 0; i < data.length; i++) {
					var row = `<tr>
                    <td>${data[i].email}</td>
                    <td>${data[i].name}</td>
                    <td>${data[i].created_at}</td>
                   </tr>`;
					table.innerHTML += row;
				}
				console.log(data);
			} catch (e) {
				console.error(e);
			}
		})();
	</script>
</body>

</html>
